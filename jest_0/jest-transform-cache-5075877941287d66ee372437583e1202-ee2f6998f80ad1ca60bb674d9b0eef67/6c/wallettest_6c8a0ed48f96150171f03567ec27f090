22406a8005c9379b5381af340f3ff5f5
const Wallet = require("../wallet/index");

const {
  verifySignature
} = require("../utils");

describe("Wallet", () => {
  let wallet;
  beforeEach(() => {
    wallet = new Wallet();
  });
  it("has a balance", () => {
    expect(wallet).toHaveProperty("balance");
  });
  it("has a public key", () => {
    expect(wallet).toHaveProperty("publicKey");
  });
  describe("signing data", () => {
    const data = "foo-bar";
    it("verifies valid signature", () => {
      expect(verifySignature({
        publicKey: wallet.publicKey,
        data,
        signature: wallet.sign(data)
      }).toBe(true));
    });
    it("does not verifies an invalid signature", () => {
      expect(verifySignature({
        publicKey: wallet.publicKey,
        data,
        signature: new Wallet().sign(data)
      }).toBe(false));
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndhbGxldC50ZXN0LmpzIl0sIm5hbWVzIjpbIldhbGxldCIsInJlcXVpcmUiLCJ2ZXJpZnlTaWduYXR1cmUiLCJkZXNjcmliZSIsIndhbGxldCIsImJlZm9yZUVhY2giLCJpdCIsImV4cGVjdCIsInRvSGF2ZVByb3BlcnR5IiwiZGF0YSIsInB1YmxpY0tleSIsInNpZ25hdHVyZSIsInNpZ24iLCJ0b0JlIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxpQkFBRCxDQUF0Qjs7QUFDQSxNQUFNO0FBQUVDLEVBQUFBO0FBQUYsSUFBc0JELE9BQU8sQ0FBQyxVQUFELENBQW5DOztBQUVBRSxRQUFRLENBQUMsUUFBRCxFQUFXLE1BQU07QUFDdkIsTUFBSUMsTUFBSjtBQUVBQyxFQUFBQSxVQUFVLENBQUMsTUFBTTtBQUNmRCxJQUFBQSxNQUFNLEdBQUcsSUFBSUosTUFBSixFQUFUO0FBQ0QsR0FGUyxDQUFWO0FBSUFNLEVBQUFBLEVBQUUsQ0FBQyxlQUFELEVBQWtCLE1BQU07QUFDeEJDLElBQUFBLE1BQU0sQ0FBQ0gsTUFBRCxDQUFOLENBQWVJLGNBQWYsQ0FBOEIsU0FBOUI7QUFDRCxHQUZDLENBQUY7QUFJQUYsRUFBQUEsRUFBRSxDQUFDLGtCQUFELEVBQXFCLE1BQU07QUFDM0JDLElBQUFBLE1BQU0sQ0FBQ0gsTUFBRCxDQUFOLENBQWVJLGNBQWYsQ0FBOEIsV0FBOUI7QUFDRCxHQUZDLENBQUY7QUFJQUwsRUFBQUEsUUFBUSxDQUFDLGNBQUQsRUFBaUIsTUFBTTtBQUM3QixVQUFNTSxJQUFJLEdBQUcsU0FBYjtBQUNBSCxJQUFBQSxFQUFFLENBQUMsMEJBQUQsRUFBNkIsTUFBTTtBQUNuQ0MsTUFBQUEsTUFBTSxDQUNKTCxlQUFlLENBQUM7QUFDZFEsUUFBQUEsU0FBUyxFQUFFTixNQUFNLENBQUNNLFNBREo7QUFFZEQsUUFBQUEsSUFGYztBQUdkRSxRQUFBQSxTQUFTLEVBQUVQLE1BQU0sQ0FBQ1EsSUFBUCxDQUFZSCxJQUFaO0FBSEcsT0FBRCxDQUFmLENBSUdJLElBSkgsQ0FJUSxJQUpSLENBREksQ0FBTjtBQU9ELEtBUkMsQ0FBRjtBQVNBUCxJQUFBQSxFQUFFLENBQUMsd0NBQUQsRUFBMkMsTUFBTTtBQUNqREMsTUFBQUEsTUFBTSxDQUNKTCxlQUFlLENBQUM7QUFDZFEsUUFBQUEsU0FBUyxFQUFFTixNQUFNLENBQUNNLFNBREo7QUFFZEQsUUFBQUEsSUFGYztBQUdkRSxRQUFBQSxTQUFTLEVBQUUsSUFBSVgsTUFBSixHQUFhWSxJQUFiLENBQWtCSCxJQUFsQjtBQUhHLE9BQUQsQ0FBZixDQUlHSSxJQUpILENBSVEsS0FKUixDQURJLENBQU47QUFPRCxLQVJDLENBQUY7QUFTRCxHQXBCTyxDQUFSO0FBcUJELENBcENPLENBQVIiLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBXYWxsZXQgPSByZXF1aXJlKFwiLi4vd2FsbGV0L2luZGV4XCIpO1xyXG5jb25zdCB7IHZlcmlmeVNpZ25hdHVyZSB9ID0gcmVxdWlyZShcIi4uL3V0aWxzXCIpO1xyXG5cclxuZGVzY3JpYmUoXCJXYWxsZXRcIiwgKCkgPT4ge1xyXG4gIGxldCB3YWxsZXQ7XHJcblxyXG4gIGJlZm9yZUVhY2goKCkgPT4ge1xyXG4gICAgd2FsbGV0ID0gbmV3IFdhbGxldCgpO1xyXG4gIH0pO1xyXG5cclxuICBpdChcImhhcyBhIGJhbGFuY2VcIiwgKCkgPT4ge1xyXG4gICAgZXhwZWN0KHdhbGxldCkudG9IYXZlUHJvcGVydHkoXCJiYWxhbmNlXCIpO1xyXG4gIH0pO1xyXG5cclxuICBpdChcImhhcyBhIHB1YmxpYyBrZXlcIiwgKCkgPT4ge1xyXG4gICAgZXhwZWN0KHdhbGxldCkudG9IYXZlUHJvcGVydHkoXCJwdWJsaWNLZXlcIik7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKFwic2lnbmluZyBkYXRhXCIsICgpID0+IHtcclxuICAgIGNvbnN0IGRhdGEgPSBcImZvby1iYXJcIjtcclxuICAgIGl0KFwidmVyaWZpZXMgdmFsaWQgc2lnbmF0dXJlXCIsICgpID0+IHtcclxuICAgICAgZXhwZWN0KFxyXG4gICAgICAgIHZlcmlmeVNpZ25hdHVyZSh7XHJcbiAgICAgICAgICBwdWJsaWNLZXk6IHdhbGxldC5wdWJsaWNLZXksXHJcbiAgICAgICAgICBkYXRhLFxyXG4gICAgICAgICAgc2lnbmF0dXJlOiB3YWxsZXQuc2lnbihkYXRhKVxyXG4gICAgICAgIH0pLnRvQmUodHJ1ZSlcclxuICAgICAgKTtcclxuICAgIH0pO1xyXG4gICAgaXQoXCJkb2VzIG5vdCB2ZXJpZmllcyBhbiBpbnZhbGlkIHNpZ25hdHVyZVwiLCAoKSA9PiB7XHJcbiAgICAgIGV4cGVjdChcclxuICAgICAgICB2ZXJpZnlTaWduYXR1cmUoe1xyXG4gICAgICAgICAgcHVibGljS2V5OiB3YWxsZXQucHVibGljS2V5LFxyXG4gICAgICAgICAgZGF0YSxcclxuICAgICAgICAgIHNpZ25hdHVyZTogbmV3IFdhbGxldCgpLnNpZ24oZGF0YSlcclxuICAgICAgICB9KS50b0JlKGZhbHNlKVxyXG4gICAgICApO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn0pO1xyXG4iXX0=