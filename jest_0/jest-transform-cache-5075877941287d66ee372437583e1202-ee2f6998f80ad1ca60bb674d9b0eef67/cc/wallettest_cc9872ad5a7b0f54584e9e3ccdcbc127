f6697e68651849a4a0d58de79eb6cc5d
const Wallet = require("../wallet/index");

const {
  verifySignature
} = require("../utils");

describe("Wallet", () => {
  let wallet;
  beforeEach(() => {
    wallet = new Wallet();
  });
  it("has a balance", () => {
    expect(wallet).toHaveProperty("balance");
  });
  it("has a public key", () => {
    expect(wallet).toHaveProperty("publicKey");
  });
  describe("signing data", () => {
    const data = "foo-bar";
    it("verifies valid signature", () => {
      expect(verifySignature({
        publicKey: wallet.publicKey,
        data,
        signature: wallet.sign(data)
      })).toBe(true);
    });
    it("does not verifies an invalid signature", () => {
      expect(verifySignature({
        publicKey: wallet.publicKey,
        data,
        signature: new Wallet().sign(data)
      })).toBe(false);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndhbGxldC50ZXN0LmpzIl0sIm5hbWVzIjpbIldhbGxldCIsInJlcXVpcmUiLCJ2ZXJpZnlTaWduYXR1cmUiLCJkZXNjcmliZSIsIndhbGxldCIsImJlZm9yZUVhY2giLCJpdCIsImV4cGVjdCIsInRvSGF2ZVByb3BlcnR5IiwiZGF0YSIsInB1YmxpY0tleSIsInNpZ25hdHVyZSIsInNpZ24iLCJ0b0JlIl0sIm1hcHBpbmdzIjoiQUFBQSxNQUFNQSxNQUFNLEdBQUdDLE9BQU8sQ0FBQyxpQkFBRCxDQUF0Qjs7QUFDQSxNQUFNO0FBQUVDLEVBQUFBO0FBQUYsSUFBc0JELE9BQU8sQ0FBQyxVQUFELENBQW5DOztBQUVBRSxRQUFRLENBQUMsUUFBRCxFQUFXLE1BQU07QUFDdkIsTUFBSUMsTUFBSjtBQUVBQyxFQUFBQSxVQUFVLENBQUMsTUFBTTtBQUNmRCxJQUFBQSxNQUFNLEdBQUcsSUFBSUosTUFBSixFQUFUO0FBQ0QsR0FGUyxDQUFWO0FBSUFNLEVBQUFBLEVBQUUsQ0FBQyxlQUFELEVBQWtCLE1BQU07QUFDeEJDLElBQUFBLE1BQU0sQ0FBQ0gsTUFBRCxDQUFOLENBQWVJLGNBQWYsQ0FBOEIsU0FBOUI7QUFDRCxHQUZDLENBQUY7QUFJQUYsRUFBQUEsRUFBRSxDQUFDLGtCQUFELEVBQXFCLE1BQU07QUFDM0JDLElBQUFBLE1BQU0sQ0FBQ0gsTUFBRCxDQUFOLENBQWVJLGNBQWYsQ0FBOEIsV0FBOUI7QUFDRCxHQUZDLENBQUY7QUFJQUwsRUFBQUEsUUFBUSxDQUFDLGNBQUQsRUFBaUIsTUFBTTtBQUM3QixVQUFNTSxJQUFJLEdBQUcsU0FBYjtBQUNBSCxJQUFBQSxFQUFFLENBQUMsMEJBQUQsRUFBNkIsTUFBTTtBQUNuQ0MsTUFBQUEsTUFBTSxDQUNKTCxlQUFlLENBQUM7QUFDZFEsUUFBQUEsU0FBUyxFQUFFTixNQUFNLENBQUNNLFNBREo7QUFFZEQsUUFBQUEsSUFGYztBQUdkRSxRQUFBQSxTQUFTLEVBQUVQLE1BQU0sQ0FBQ1EsSUFBUCxDQUFZSCxJQUFaO0FBSEcsT0FBRCxDQURYLENBQU4sQ0FNRUksSUFORixDQU1PLElBTlA7QUFPRCxLQVJDLENBQUY7QUFTQVAsSUFBQUEsRUFBRSxDQUFDLHdDQUFELEVBQTJDLE1BQU07QUFDakRDLE1BQUFBLE1BQU0sQ0FDSkwsZUFBZSxDQUFDO0FBQ2RRLFFBQUFBLFNBQVMsRUFBRU4sTUFBTSxDQUFDTSxTQURKO0FBRWRELFFBQUFBLElBRmM7QUFHZEUsUUFBQUEsU0FBUyxFQUFFLElBQUlYLE1BQUosR0FBYVksSUFBYixDQUFrQkgsSUFBbEI7QUFIRyxPQUFELENBRFgsQ0FBTixDQU1FSSxJQU5GLENBTU8sS0FOUDtBQU9ELEtBUkMsQ0FBRjtBQVNELEdBcEJPLENBQVI7QUFxQkQsQ0FwQ08sQ0FBUiIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFdhbGxldCA9IHJlcXVpcmUoXCIuLi93YWxsZXQvaW5kZXhcIik7XHJcbmNvbnN0IHsgdmVyaWZ5U2lnbmF0dXJlIH0gPSByZXF1aXJlKFwiLi4vdXRpbHNcIik7XHJcblxyXG5kZXNjcmliZShcIldhbGxldFwiLCAoKSA9PiB7XHJcbiAgbGV0IHdhbGxldDtcclxuXHJcbiAgYmVmb3JlRWFjaCgoKSA9PiB7XHJcbiAgICB3YWxsZXQgPSBuZXcgV2FsbGV0KCk7XHJcbiAgfSk7XHJcblxyXG4gIGl0KFwiaGFzIGEgYmFsYW5jZVwiLCAoKSA9PiB7XHJcbiAgICBleHBlY3Qod2FsbGV0KS50b0hhdmVQcm9wZXJ0eShcImJhbGFuY2VcIik7XHJcbiAgfSk7XHJcblxyXG4gIGl0KFwiaGFzIGEgcHVibGljIGtleVwiLCAoKSA9PiB7XHJcbiAgICBleHBlY3Qod2FsbGV0KS50b0hhdmVQcm9wZXJ0eShcInB1YmxpY0tleVwiKTtcclxuICB9KTtcclxuXHJcbiAgZGVzY3JpYmUoXCJzaWduaW5nIGRhdGFcIiwgKCkgPT4ge1xyXG4gICAgY29uc3QgZGF0YSA9IFwiZm9vLWJhclwiO1xyXG4gICAgaXQoXCJ2ZXJpZmllcyB2YWxpZCBzaWduYXR1cmVcIiwgKCkgPT4ge1xyXG4gICAgICBleHBlY3QoXHJcbiAgICAgICAgdmVyaWZ5U2lnbmF0dXJlKHtcclxuICAgICAgICAgIHB1YmxpY0tleTogd2FsbGV0LnB1YmxpY0tleSxcclxuICAgICAgICAgIGRhdGEsXHJcbiAgICAgICAgICBzaWduYXR1cmU6IHdhbGxldC5zaWduKGRhdGEpXHJcbiAgICAgICAgfSlcclxuICAgICAgKS50b0JlKHRydWUpO1xyXG4gICAgfSk7XHJcbiAgICBpdChcImRvZXMgbm90IHZlcmlmaWVzIGFuIGludmFsaWQgc2lnbmF0dXJlXCIsICgpID0+IHtcclxuICAgICAgZXhwZWN0KFxyXG4gICAgICAgIHZlcmlmeVNpZ25hdHVyZSh7XHJcbiAgICAgICAgICBwdWJsaWNLZXk6IHdhbGxldC5wdWJsaWNLZXksXHJcbiAgICAgICAgICBkYXRhLFxyXG4gICAgICAgICAgc2lnbmF0dXJlOiBuZXcgV2FsbGV0KCkuc2lnbihkYXRhKVxyXG4gICAgICAgIH0pXHJcbiAgICAgICkudG9CZShmYWxzZSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7XHJcbiJdfQ==